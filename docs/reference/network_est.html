<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>A function to run an MCMC sampler based on the Iterative Conditional Modes (ICM) algorithm: — network_est • HPprediction</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="A function to run an MCMC sampler based on the Iterative Conditional Modes (ICM) algorithm: — network_est" />
<meta property="og:description" content="Parameter set-up
`y` is the initial value for the host affinity parameters
`w` is the initial value for the parasite affinity parameters
`a_y` is the shape parameter for the gamma prior on the host affinity parameters
`a_w` is the shape parameter for the gamma prior on the parasite affinity parameters
`b_y` is the rate parameter for the gamma prior on the host affinity parameters
`b_w` is the rate parameter for the gamma prior on the parasite affinity parameters
`y_sd` is the standard deviation of the proposal distribution for the host affinity parameters (normal distribution with mean zero and standard deviation y_sd).
`w_sd` is the standard deviation of the proposal distribution for the parasite affinity parameters (normal distribution with mean zero and standard deviation w_sd).
`eta` is the initial value for the tree scaling parameter eta ('distance' and 'full' models)
`eta_sd` is the standard deviation of the proposal distribution for the eta parameter (normal distribution with mean zero and standard deviation eta_sd)
Burn-in set-up
`burn.in` sets the proportion of initial slices to discard from the posterior (default is 0.5)
Metropolis Hastings adapation set-up
`batch_size` is the Metropolis Hastings adaptiveness for updating hyperparameters. Indicated by a number of samples, this is how often the hyperparameters are updated during sampling. This is only used for the 'affinity' model, for all other models the batch size is set to 1. 
`beta` is the adaptation parameter for the Metropolis Hastings algorithm." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">HPprediction</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/HPprediction.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/melmasri/HPprediction/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>A function to run an MCMC sampler based on the Iterative Conditional Modes (ICM) algorithm:</h1>
    <small class="dont-index">Source: <a href='https://github.com/melmasri/HPprediction/blob/master/R/network_est.R'><code>R/network_est.R</code></a></small>
    <div class="hidden name"><code>network_est.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Parameter set-up</p>
<p>`y` is the initial value for the host affinity parameters
`w` is the initial value for the parasite affinity parameters
`a_y` is the shape parameter for the gamma prior on the host affinity parameters
`a_w` is the shape parameter for the gamma prior on the parasite affinity parameters
`b_y` is the rate parameter for the gamma prior on the host affinity parameters
`b_w` is the rate parameter for the gamma prior on the parasite affinity parameters
`y_sd` is the standard deviation of the proposal distribution for the host affinity parameters (normal distribution with mean zero and standard deviation y_sd).
`w_sd` is the standard deviation of the proposal distribution for the parasite affinity parameters (normal distribution with mean zero and standard deviation w_sd).</p>
<p>`eta` is the initial value for the tree scaling parameter eta ('distance' and 'full' models)
`eta_sd` is the standard deviation of the proposal distribution for the eta parameter (normal distribution with mean zero and standard deviation eta_sd)</p>
<p>Burn-in set-up</p>
<p>`burn.in` sets the proportion of initial slices to discard from the posterior (default is 0.5)</p>
<p>Metropolis Hastings adapation set-up</p>
<p>`batch_size` is the Metropolis Hastings adaptiveness for updating hyperparameters. Indicated by a number of samples, this is how often the hyperparameters are updated during sampling. This is only used for the 'affinity' model, for all other models the batch size is set to 1. 
`beta` is the adaptation parameter for the Metropolis Hastings algorithm.</p>
    </div>

    <pre class="usage"><span class='fu'>network_est</span>(
  <span class='no'>Z</span>,
  <span class='kw'>tree</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>slices</span> <span class='kw'>=</span> <span class='fl'>10</span>,
  <span class='kw'>model.type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"full"</span>, <span class='st'>"distance"</span>, <span class='st'>"affinity"</span>),
  <span class='kw'>uncertainty</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>sparse</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>Z</th>
      <td><p>bipartite interaction matrix</p></td>
    </tr>
    <tr>
      <th>tree</th>
      <td><p>'phylo' object representing rows of Z</p></td>
    </tr>
    <tr>
      <th>slices</th>
      <td><p>The total number of samples to take</p></td>
    </tr>
    <tr>
      <th>model.type</th>
      <td><p>Indicate model to use: one of 'full', 'distance', 'affinity'</p></td>
    </tr>
    <tr>
      <th>uncertainty</th>
      <td><p>Indicate whether to use model variant that accounts for uncertainty in unobserved interactions.</p></td>
    </tr>
    <tr>
      <th>sparse</th>
      <td><p>Indicate whether to use the sparseMatrix function from the Matix package. This option is advised for large matrices.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional parameters that are passed to fullJoint_est (for the 'affinity' model), and ICM_est (for the 'full' and 'distance' models) - see Description</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns a list of the posterior samples for each of the estimated parameters.
`y` are the host affinity parameters (for the 'affinity' and 'full  models')
`w` are the parasite affinity parameters (for the 'affinity' and 'full  models')
`eta` is the phylogeny scaling paramers (for 'distance' and 'full' models)
`g` is the uncertainty parameter (if uncertainty=TRUE)
`burn.in` is the number of slices discarded for burn-in
`sd` is a list of the standard deviation parameters (representing y_sd, w_sd, and eta_sd according to the model chosen)</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'># Simluate a tree and Z matrix</span>
<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='no'>tree</span> <span class='kw'>&lt;-</span> <span class='fu'>rcoal</span>(<span class='fl'>50</span>)
<span class='no'>Z</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/Binomial.html'>rbinom</a></span>(<span class='fl'>50</span>*<span class='fl'>200</span>, <span class='fl'>1</span>, <span class='fl'>0.01</span>), <span class='kw'>nrow</span><span class='kw'>=</span><span class='fl'>50</span>, <span class='kw'>ncol</span><span class='kw'>=</span><span class='fl'>200</span>)
<span class='no'>Z</span> <span class='kw'>&lt;-</span> <span class='no'>Z</span>[,<span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>colSums</a></span>(<span class='no'>Z</span>)<span class='kw'>&gt;</span><span class='fl'>0</span>]
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>rownames</a></span>(<span class='no'>Z</span>) <span class='kw'>&lt;-</span> <span class='no'>tree</span>$<span class='no'>tip.label</span>

<span class='co'># Clean the network and tree</span>
<span class='no'>out</span> <span class='kw'>&lt;-</span> <span class='fu'>network_est</span>(<span class='no'>Z</span>, <span class='no'>tree</span>, <span class='kw'>model</span><span class='kw'>=</span><span class='st'>'full'</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/str.html'>str</a></span>(<span class='no'>out</span>)
}</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Mohamad Elmasri.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


